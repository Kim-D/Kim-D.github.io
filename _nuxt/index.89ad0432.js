import{_ as G}from"./nuxt-link.3df1dd84.js";import{f as O,r as p,y as j,i as q,o as r,j as i,w as e,b as o,k as n,l as M,d as m,t as v,c as k,m as g,F as x,q as h,n as N}from"./entry.c4ebd43d.js";import{u as R}from"./KForm.vue.8f51e837.js";import{u as E}from"./index.f27507dc.js";import{_ as w}from"./Stack.vue.bd4d8877.js";import{C as I,b as U}from"./customer.api.3d102103.js";import{u as z,_ as H}from"./useLabelGroup.6f5a80bd.js";import{_ as J,a as K}from"./Divider.vue.c1daa5d1.js";import{L as P,a as Q}from"./List.cebf833c.js";import{T as d}from"./Text.bed8161d.js";import{_ as W}from"./Flex.vue.8a6b864f.js";import{a as X}from"./KDateRangePicker.vue.176744ed.js";import{t as Y}from"./index.d7501e1d.js";import"./Button.a6d1e8d0.js";import"./KRadioGroup.a041d2e3.js";import"./Input.aba85dfb.js";import"./Avatar.cca694e9.js";import"./createPopper.81b77d5f.js";import"./disposables.47903ef7.js";import"./KImageUpload.effa1968.js";import"./Icon.85766b0e.js";import"./index.df58e121.js";import"./useModal.1d49dae4.js";import"./BarcodeReader.vue.c0f2a4d2.js";import"./KSwipeModal.fccfb107.js";import"./SignaturePad.vue.0ab69b12.js";import"./Box.03872979.js";import"./Title.e07643fd.js";import"./KButton.55ae4892.js";import"./api.184bdff1.js";const De=O({__name:"index",setup(Z){E("고객 관리");const u=p(0),_=p(0),c=p(1),a=p([]),L=j(),{schema:T,items:C,state:s,handleSubmit:S}=R(I,[{name:"facNm",label:"고객명(현장명)",type:"text"},{name:"repTelNo",label:"대표전화 번호",type:"text"},{name:"facBasAdr",label:"주소",type:"text"}],async t=>{await N(),t&&(u.value===0?u.value=1:u.value=0,a.value=[],_.value=0,c.value=1)}),B=z(a,[{key:"facSeq",label:"현장 일련 번호"},{key:"facNm",label:"현장 이름"},{key:"repTelNo",label:"전화번호"},{key:"facBasAdr",label:"주소"},{key:"facDtlAdr",label:"상세주소"},{key:"setDt",label:"설치일자",formatter(t){return t?X(t):""}}]);function D(t){return`/customer/detail/${t}`}async function V(t){if(a.value.length!==0&&a.value.length>=_.value){t.complete();return}try{const l=await U(c.value,10,s.value.facNm,s.value.repTelNo,s.value.facBasAdr);_.value=l.data.totalRows,a.value=a.value.concat(l.data.items),l.data.items.length<10?t.complete():(c.value=c.value+1,t.loaded())}catch(l){L.add({type:"error",text:l.message})}}return Y(async()=>{console.log("========= tryOnMounted - ",a),a.value=[],await N()}),(t,l)=>{const A=G,$=q("infinite-loading");return r(),i(w,null,{default:e(()=>[o(H,{modelValue:n(s),"onUpdate:modelValue":l[0]||(l[0]=f=>M(s)?s.value=f:null),items:n(C),schema:n(T),onSubmit:n(S)},null,8,["modelValue","items","schema","onSubmit"]),o(J,null,{default:e(()=>[m(v(n(a).length),1)]),_:1}),o(K),o(Q,null,{default:e(()=>[(r(!0),k(x,null,g(n(B),(f,F)=>(r(),i(P,{key:F,class:"border-b"},{default:e(()=>[o(A,{to:D(f[0].value)},{default:e(()=>[o(w,{gap:.25},{default:e(()=>[(r(!0),k(x,null,g(f,(b,y)=>(r(),i(W,{key:y,justify:"between"},{default:e(()=>[y>0?(r(),i(d,{key:0},{default:e(()=>[m(v(b.label),1)]),_:2},1024)):h("",!0),y>0?(r(),i(d,{key:1,align:"right"},{default:e(()=>[m(v(b.value),1)]),_:2},1024)):h("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1}),o($,{class:"w-full text-center",identifier:n(u),onInfinite:V},{complete:e(()=>[o(d,null,{default:e(()=>[m("마지막 항목 입니다.")]),_:1})]),spinner:e(()=>[o(d,null,{default:e(()=>[m(" loading... ")]),_:1})]),_:1},8,["identifier"])]),_:1})}}});export{De as default};
