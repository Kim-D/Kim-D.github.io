import{_ as G}from"./nuxt-link.0282fad6.js";import{f as O,r as p,y as j,i as q,o as r,j as i,w as e,b as o,k as n,l as M,d as m,t as v,c as k,m as g,F as x,q as h,n as N}from"./entry.bf64b599.js";import{u as R}from"./KForm.vue.35a1ec8c.js";import{u as E}from"./index.0d8a044b.js";import{_ as w}from"./Stack.vue.f2e87cfc.js";import{C as I,b as U}from"./customer.api.10300d73.js";import{u as z,_ as H}from"./useLabelGroup.2723abbd.js";import{_ as J,a as K}from"./Divider.vue.f1dcccbe.js";import{L as P,a as Q}from"./List.b3513e41.js";import{T as d}from"./Text.521f1a84.js";import{_ as W}from"./Flex.vue.05e8867f.js";import{a as X}from"./KDateRangePicker.vue.a53e4ed9.js";import{t as Y}from"./index.6949dd38.js";import"./Button.ed1ba773.js";import"./KRadioGroup.99df7f19.js";import"./Input.ea2a240b.js";import"./Avatar.7f45d98b.js";import"./createPopper.81b77d5f.js";import"./disposables.62724182.js";import"./KImageUpload.ddbba17d.js";import"./Icon.54269085.js";import"./index.df58e121.js";import"./useModal.e0651368.js";import"./BarcodeReader.vue.b797d3e9.js";import"./KSwipeModal.a8714521.js";import"./SignaturePad.vue.7fdbcfae.js";import"./Box.028b2dfc.js";import"./Title.295950d5.js";import"./KButton.1dc6351c.js";import"./api.882d370b.js";const De=O({__name:"index",setup(Z){E("고객 관리");const u=p(0),_=p(0),c=p(1),a=p([]),L=j(),{schema:T,items:C,state:s,handleSubmit:S}=R(I,[{name:"facNm",label:"고객명(현장명)",type:"text"},{name:"repTelNo",label:"대표전화 번호",type:"text"},{name:"facBasAdr",label:"주소",type:"text"}],async t=>{await N(),t&&(u.value===0?u.value=1:u.value=0,a.value=[],_.value=0,c.value=1)}),B=z(a,[{key:"facSeq",label:"현장 일련 번호"},{key:"facNm",label:"현장 이름"},{key:"repTelNo",label:"전화번호"},{key:"facBasAdr",label:"주소"},{key:"facDtlAdr",label:"상세주소"},{key:"setDt",label:"설치일자",formatter(t){return t?X(t):""}}]);function D(t){return`/customer/detail/${t}`}async function V(t){if(a.value.length!==0&&a.value.length>=_.value){t.complete();return}try{const l=await U(c.value,10,s.value.facNm,s.value.repTelNo,s.value.facBasAdr);_.value=l.data.totalRows,a.value=a.value.concat(l.data.items),l.data.items.length<10?t.complete():(c.value=c.value+1,t.loaded())}catch(l){L.add({type:"error",text:l.message})}}return Y(async()=>{console.log("========= tryOnMounted - ",a),a.value=[],await N()}),(t,l)=>{const A=G,$=q("infinite-loading");return r(),i(w,null,{default:e(()=>[o(H,{modelValue:n(s),"onUpdate:modelValue":l[0]||(l[0]=f=>M(s)?s.value=f:null),items:n(C),schema:n(T),onSubmit:n(S)},null,8,["modelValue","items","schema","onSubmit"]),o(J,null,{default:e(()=>[m(v(n(a).length),1)]),_:1}),o(K),o(Q,null,{default:e(()=>[(r(!0),k(x,null,g(n(B),(f,F)=>(r(),i(P,{key:F,class:"border-b"},{default:e(()=>[o(A,{to:D(f[0].value)},{default:e(()=>[o(w,{gap:.25},{default:e(()=>[(r(!0),k(x,null,g(f,(b,y)=>(r(),i(W,{key:y,justify:"between"},{default:e(()=>[y>0?(r(),i(d,{key:0},{default:e(()=>[m(v(b.label),1)]),_:2},1024)):h("",!0),y>0?(r(),i(d,{key:1,align:"right"},{default:e(()=>[m(v(b.value),1)]),_:2},1024)):h("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1}),o($,{class:"w-full text-center",identifier:n(u),onInfinite:V},{complete:e(()=>[o(d,null,{default:e(()=>[m("마지막 항목 입니다.")]),_:1})]),spinner:e(()=>[o(d,null,{default:e(()=>[m(" loading... ")]),_:1})]),_:1},8,["identifier"])]),_:1})}}});export{De as default};
